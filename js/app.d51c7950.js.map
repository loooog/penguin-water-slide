{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/engine/liquidfun/draw-extensions.js","webpack:///./src/assets/background.png","webpack:///./src/App.vue?b9c2","webpack:///./src/engine/liquidfun/ExternalsResolver.js","webpack:///./src/engine/liquidfun/DynamicBodyQueryCallback.js","webpack:///./src/utils/lerp.js","webpack:///./src/engine/DebugLayer.js","webpack:///./src/engine/LiquidParticles.js","webpack:///./src/engine/Renderer.js","webpack:///./src/engine/Shapes.js","webpack:///./src/engine/Simulation.js","webpack:///./src/engine/LiquidShader.js","webpack:///./src/engine/LayersBlendShader.js","webpack:///./src/engine/Penguin.js","webpack:///./src/engine/Stage.js","webpack:///src/App.vue","webpack:///./src/App.vue?1160","webpack:///./src/App.vue","webpack:///./src/main.js","webpack:///./src/App.vue?c650","webpack:///./src/assets/penguin.png"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","draw","transform","renderer","circlePosition","this","position","center","x","y","insertCircleVertices","radius","zPosition","currentVertex","transformVerticesAndInsert","vertices","positions","last","insertLine","_vm","_h","$createElement","_c","_self","attrs","ref","staticClass","on","toggleCameraMode","_v","_s","cameraMode","staticRenderFns","b2World","b2_dynamicBody","b2PolygonShape","b2CircleShape","b2Vec2","b2BodyDef","b2ParticleSystemDef","b2ParticleGroupDef","b2MouseJointDef","b2AABB","DynamicBodyQueryCallback","point","fixture","body","GetType","inside","TestPoint","lerp","a","b","DebugLayer","v","resolution","size","s1","Math","PI","s2","cos","sin","v1","v2","g","transformedV1","transformedV2","Mul","vertexCount","transformAndInsert","maxVertices","geometry","BufferGeometry","dynamic","setAttribute","BufferAttribute","Float32Array","attributes","array","colors","color","buffer","LineSegments","LineBasicMaterial","vertexColors","circleVertices","circleResolution","initCircleVertices","particleVertices","particleResolution","bodies","max","maxFixtures","fixtures","GetTransform","shape","collapseBuffer","needsUpdate","x1","y1","x2","y2","threeI","i4","inv255","vertexShader","fragmentShader","LiquidParticles","world","numberOfParticles","particleSystems","GetPositionBuffer","InstancedBufferGeometry","copy","PlaneBufferGeometry","offsets","scales","InstancedBufferAttribute","material","RawShaderMaterial","uniforms","time","orientation","type","Quaternion","depthWrite","side","FrontSide","transparent","alphaTest","blending","NormalBlending","frustumCulled","resetBuffers","system","particles","GetColorBuffer","offsetsArray","offset","colorsArray","i2","i3","velocities","GetVelocityBuffer","random","Mesh","Renderer","antialias","alpha","setClearColor","setSize","windowWidth","windowHeight","setPixelRatio","devicePixelRatio","shadowMap","enabled","gl","getContext","getExtension","alert","Error","getParameter","MAX_VERTEX_TEXTURE_IMAGE_UNITS","WebGLRenderer","walls","Simulation","numberOfPenguins","spawnAreaRadius","liquidColor","gravity","groundBodyDef","groundBody","CreateBody","makeWalls","makeLiquidParticles","makePengiuns","def","ground","wall","xy","CreateFixtureFromShape","psd","particleSystem","CreateParticleSystem","spawnArea","Set","particleGroupDefinition","CreateParticleGroup","penguinVertices","penguin","scale","bd","sleep","triangle","vertice","childName","SetTransform","SetLinearVelocity","SetAngularVelocity","joints","DestroyJoint","DestroyBody","DestroyParticleSystem","LiquidShader","tDiffuse","LayersBlendShader","Penguin","map","TextureLoader","load","require","texture","wrapT","RepeatWrapping","repeat","SpriteMaterial","GetWorldCenter","angle","GetAngle","imageSize","width","height","set","rotation","Sprite","Stage","container","debugPhysics","velocityIterations","positionIterations","renderCallBack","requestAnimationFrame","loop","render","stageWidth","innerWidth","stageHeight","innerHeight","camera","aspect","updateProjectionMatrix","composerBackground","composerLiquid","composerForeground","event","mouseJoint","simulation","getMouseCoords","aabb","Sub","lowerBound","Add","upperBound","queryCallback","QueryAABB","md","bodyA","bodyB","target","maxForce","GetMass","CreateJoint","SetAwake","targetToFollow","SetTarget","clock","Clock","settings","PerspectiveCamera","sceneBackground","Scene","sceneLiquid","sceneForeground","appendChild","domElement","liquidParticles","add","debugLayer","backgroundMap","backgroundMaterial","background","z","renderPassBackground","RenderPass","renderPassLiquid","renderPassForeground","backgroundCopyPass","ShaderPass","CopyShader","effectLiquid","liquidCopyPass","blendPass","EffectComposer","addPass","textureBackground","renderTarget1","textureLiquid","renderToScreen","penguins","addListeners","handleWindowResize","instance","destroy","setcameraMode","paused","pt","elapsedTime","delta","getDelta","Step","min","clear","clientX","clientY","touches","getBoundingClientRect","top","left","mouse","Vector3","unproject","dir","sub","normalize","distance","pos","clone","multiplyScalar","cancelAnimationFrame","removeListeners","document","addEventListener","handleMouseDown","handleMouseMove","handleMouseUp","removeEventListener","mounted","beforeDestroy","methods","component","Vue","config","productionTip","h","App","$mount","handleResize","parent","postMessage","location","origin","e"],"mappings":"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","file":"js/app.d51c7950.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t\"app\": 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"//mikatalk.github.io/penguin-water-slide/\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([0,\"chunk-vendors\"]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","/////////////////////////////////////////////////////////////////////////////////////\n//  The section below implement the draw method on b2 shapes to copy the vertices  //\n//  positions to the renderer buffer                                               //\n/////////////////////////////////////////////////////////////////////////////////////\n\nwindow['b2CircleShape'].prototype.draw = function(transform, renderer) {\n  const circlePosition = this.position\n  const center = new window['b2Vec2'](circlePosition.x, circlePosition.y)\n  renderer.insertCircleVertices(transform, this.radius, center.x, center.y, 0, 0, 0, 5)\n}\n\nwindow['b2PolygonShape'].prototype.draw = function(transform, renderer) {\n  const zPosition = renderer.currentVertex * 3\n  renderer.transformVerticesAndInsert(this.vertices, transform, 0, 0, 0)\n  const positions = renderer.positions\n  const last = (renderer.currentVertex - 1) * 3\n  renderer.insertLine(positions[last], positions[last + 1],\n                      positions[zPosition], positions[zPosition + 1],\n                      0, 0, 0)\n}\n","module.exports = __webpack_public_path__ + \"img/background.8eb8eaf1.png\";","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"app\"}},[_c('div',{ref:\"canvas-container\",staticClass:\"canvas-container\"}),_c('button',{on:{\"click\":_vm.toggleCameraMode}},[_vm._v(\"Toggle Camera View - \"+_vm._s(_vm.cameraMode))])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","// Although we setup externals already in the webpack config, \n// eslint was still complaining so this is just a proxy to the \n// library loaded via traditional script tag,\n// and already available in the window\n\n// load extensions \nimport './draw-extensions'\n// link to global library\nexport const b2World = window['b2World']\nexport const b2_tensileParticle = window['b2_tensileParticle']\nexport const b2_dynamicBody = window['b2_dynamicBody']\nexport const b2PolygonShape = window['b2PolygonShape']\nexport const b2CircleShape = window['b2CircleShape']\nexport const b2Vec2 = window['b2Vec2']\nexport const b2BodyDef = window['b2BodyDef']\nexport const b2ParticleSystemDef = window['b2ParticleSystemDef']\nexport const b2ParticleGroupDef = window['b2ParticleGroupDef']\nexport const b2_waterParticle = window['b2_waterParticle']\nexport const b2_colorMixingParticle = window['b2_colorMixingParticle']\nexport const b2MouseJointDef = window['b2MouseJointDef']\nexport const b2AABB = window['b2AABB']\n","import { b2_dynamicBody } from './ExternalsResolver'\n\nexport default class DynamicBodyQueryCallback {\n  \n  constructor (point) {\n    this.point = point\n    this.fixture = null\n  }\n\n  ReportFixture (fixture) {\n    var body = fixture.body\n    if (body.GetType() === b2_dynamicBody) {\n      var inside = fixture.TestPoint(this.point)\n      if (inside) {\n        this.fixture = fixture\n        return true\n      }\n    }\n    return false\n  }\n}\n","export const lerp = (a, b, i) => (a * i) + (b * (1-i))\n","import { BufferGeometry, BufferAttribute, LineSegments, LineBasicMaterial } from 'three'\nimport { b2Vec2 } from './liquidfun/ExternalsResolver'\n\nexport default class DebugLayer {\n  constructor () {\n\n    // init large buffer geometry\n    this.maxVertices = 500\n    var geometry = new BufferGeometry()\n    geometry.dynamic = true\n\n    geometry.setAttribute('position', new BufferAttribute(new Float32Array(this.maxVertices * 3), 3))\n    geometry.setAttribute('color', new BufferAttribute(new Float32Array(this.maxVertices * 3), 3))\n\n    this.positions = geometry.attributes.position.array\n    this.colors = geometry.attributes.color.array\n    this.currentVertex = 0\n    this.buffer = new LineSegments(geometry,\n      new LineBasicMaterial({ \n        vertexColors: true,\n      }), LineSegments)\n\n    this.circleVertices = []\n    this.circleResolution = 10\n    this.initCircleVertices(this.circleVertices, this.circleResolution)\n\n    this.particleVertices = []\n    this.particleResolution = 3\n    this.initCircleVertices(this.particleVertices, this.particleResolution)\n  }\n\n  collapseBuffer () {\n    var i = this.currentVertex * 3\n    for (; i < this.maxVertices * 3; i++) {\n      this.positions[i] = 0\n      this.colors[i] = 0\n    }\n  }\n\n  // draw ({bodies, particleSystems}) {\n  draw ({bodies}) {\n    for (var i = 0, max = bodies.length; i < max; i++) {\n      var body = bodies[i]\n      var maxFixtures = body.fixtures.length\n      var transform = body.GetTransform()\n      for (var j = 0; j < maxFixtures; j++) {\n        var fixture = body.fixtures[j]\n        fixture.shape.draw(transform, this)\n      }\n    }\n\n    /********************************* \n    // draw particle systems\n    for (let system of particleSystems) {\n      const particles = system.GetPositionBuffer()\n      const color = system.GetColorBuffer()\n      // console.log({particles, color})\n      \n      \n      const transform = new b2Transform()\n      transform.SetIdentity()\n      \n      // loop over all particles\n      for (var i2 = 0, i4 = 0, l = particles.length; i2 < l; i2 += 2, i4 += 4) {\n        this.insertParticleVertices(\n          system.radius,\n          particles[i2],\n          particles[i2 + 1],\n          color[i4] * inv255, color[i4 + 1] * inv255, color[i4 + 2] * inv255,\n          3\n          )\n        }\n      }\n      */\n        \n        this.collapseBuffer()\n        \n        this.buffer.geometry.attributes.position.needsUpdate = true\n    this.buffer.geometry.attributes.color.needsUpdate = true\n  }\n\n  insertLine (x1, y1, x2, y2, r, g, b) {\n    var i = this.currentVertex;\n    var threeI = i * 3;\n    this.positions[threeI] = x1;\n    this.positions[threeI + 1] = y1;\n    this.positions[threeI + 2] = 0;\n    this.colors[threeI] = r;\n    this.colors[threeI + 1] = g;\n    this.colors[threeI + 2] = b;\n\n    i++;\n    threeI = i * 3;\n    this.positions[threeI] = x2;\n    this.positions[threeI + 1] = y2;\n    this.positions[threeI + 2] = 0;\n    this.colors[threeI] = r;\n    this.colors[threeI + 1] = g;\n    this.colors[threeI + 2] = b;\n    this.currentVertex += 2;\n  }\n\n  // TODO remove one of the muls\n  insertCircleVertices (transform, radius, x, y, r, g, b) {\n    var vertices = this.circleVertices;\n    for (var i = 0; i < this.circleResolution; i++) {\n      var i4 = i * 4;\n      var v1 = new b2Vec2(vertices[i4] * radius + x, vertices[i4 + 1] * radius + y);\n      var v2 = new b2Vec2(vertices[i4 + 2] * radius + x, vertices[i4 + 3] * radius + y);\n\n      b2Vec2.Mul(v1, transform, v1);\n      b2Vec2.Mul(v2, transform, v2);\n\n      this.insertLine(v1.x, v1.y, v2.x, v2.y, r, g, b);\n    }\n  }\n\n  insertParticleVertices (radius, x, y, r, g, b) {\n    var vertices = this.particleVertices;\n    for (var i = 0; i < this.particleResolution; i++) {\n      var i4 = i * 4;\n      var x1 = vertices[i4] * radius + x;\n      var y1 = vertices[i4 + 1] * radius + y;\n      var x2 = vertices[i4 + 2] * radius + x;\n      var y2 = vertices[i4 + 3] * radius + y;\n\n      this.insertLine(x1, y1, x2, y2, r, g, b);\n    }\n  }\n\n  initCircleVertices = function(v, resolution) {\n    var size = 360 / resolution;\n\n    for (var i = 0; i < resolution; i++) {\n      var s1 = (i * size) * Math.PI / 180;\n      var s2 = ((i + 1) * size) * Math.PI / 180;\n      v.push(Math.cos(s1));\n      v.push(Math.sin(s1));\n      v.push(Math.cos(s2));\n      v.push(Math.sin(s2));\n    }\n  }\n\n\n  transformAndInsert = function(v1, v2, transform, r, g, b) {\n    var transformedV1 = new b2Vec2(),\n      transformedV2 = new b2Vec2();\n\n    b2Vec2.Mul(transformedV1, transform, v1);\n    b2Vec2.Mul(transformedV2, transform, v2);\n    this.insertLine(transformedV1.x, transformedV1.y,\n      transformedV2.x, transformedV2.y,\n      r, g, b);\n  }\n\n  transformVerticesAndInsert = function(vertices, transform, r, g, b) {\n    var vertexCount = vertices.length;\n\n    for (var i = 1; i < vertexCount; i++) {\n      this.transformAndInsert(vertices[i - 1], vertices[i], transform,\n        r, g, b);\n    }\n  }\n}\n\n","import {\n  Mesh,\n  PlaneBufferGeometry,\n  InstancedBufferGeometry,\n  InstancedBufferAttribute,\n  RawShaderMaterial,\n  Quaternion,\n  FrontSide,\n  NormalBlending\n} from 'three'\n\nconst inv255 = .003921569\n\nconst vertexShader = `\n  precision highp float;\n\n  #define PI 3.1415926536\n  #define PI2 6.28318530718\n\n  attribute vec3 position;\n  attribute vec3 offset;\n  attribute vec4 color;\n  attribute float scale;\n  uniform mat4 modelViewMatrix;\n  uniform mat4 projectionMatrix;\n  uniform float time;\n  attribute vec2 uv;\n  varying vec2 vUv;\n  varying vec4 vColor;\n  attribute float particleIndex;\n  uniform vec4 orientation;\n  \n  vec3 applyQuaternionToVector( vec4 q, vec3 v ){\n    return v + 2.0 * cross( q.xyz, cross( q.xyz, v ) + q.w * v );\n  }\n\n  void main(){\n\n    vColor = color;\n    vec3 pos = position * vec3(scale, scale, 1.0);\n    pos = applyQuaternionToVector(orientation, pos);\n    pos = pos + offset;\n    vUv = vec2(uv.x, 1.0-uv.y);\n    gl_Position = projectionMatrix * modelViewMatrix * vec4(pos, 1.0 );\n  }\n`\nconst fragmentShader = `\n  precision highp float;\n\n  varying vec4 vColor;\n  varying vec2 vUv;\n\n  float drawBase (in vec2 uv, in float min, in float max) {\n    float dist = sqrt(dot(uv, uv));\n    if (dist >= max || dist <= min) {\n      return 0.0;\n    }\n    float sm = smoothstep(max, max - 0.01, dist);\n    float sm2 = smoothstep(min, min - 0.01, dist);\n    float alpha = sm * sm2;\n    return (1.0-alpha);\n  }\n\n  void main() {\n    float alpha = drawBase(vUv - vec2(0.5), 0.0, 0.5);\n    // discard if not needed\n    if (alpha == 0.0) {\n      discard;\n    }\n    vec4 color = vColor;\n    color.a = alpha * max(0.0, 0.6 - sin(length(vUv - vec2(0.5)))) * 0.4;\n    gl_FragColor = clamp(vec4(0), vec4(1), color);\n  }\n`\n\nexport default class LiquidParticles extends Mesh {\n  \n  constructor ({world}) {\n    // count how many liquid particles were created in the simulation \n    // and create as many instances for the renderer\n    const numberOfParticles = world.particleSystems[0].GetPositionBuffer().length / 2\n    \n    \n    // create an instanced buffer from a plane buffer geometry \n    const geometry = new InstancedBufferGeometry()\n    geometry.copy(new PlaneBufferGeometry(1, 1, 1, 1))\n    // Add/generate attributes buffers for the geometry\n    const offsets = []\n    const colors = []\n    const scales = []\n    for (let i = 0; i < numberOfParticles; i += 1) {\n      offsets.push(\n        0, 0, 0\n      )\n      colors.push(\n        0, 0, 0, 0\n      )\n      scales.push(0.6)\n    }\n    geometry.setAttribute('offset', new InstancedBufferAttribute(new Float32Array(offsets), 3))\n    geometry.setAttribute('color', new InstancedBufferAttribute(new Float32Array(colors), 4))\n    geometry.setAttribute('scale', new InstancedBufferAttribute(new Float32Array(scales), 1))\n      \n    const material = new RawShaderMaterial( {\n      uniforms: {\n        time: { value: 1.0 },\n        orientation: {type: 'v4', value: new Quaternion()},\n      },\n      vertexShader,\n      fragmentShader,\n      depthWrite:false,\n      side: FrontSide, // only front since the plane will always face the camera\n      transparent: true,\n      alphaTest: 0.005,\n      blending: NormalBlending\n    })\n\n    super(geometry, material)\n    \n    this.numberOfParticles = numberOfParticles\n    this.frustumCulled = false\n    this.resetBuffers(world)\n  }\n\n  resetBuffers (world) {\n    for (let system of world.particleSystems) {\n      const particles = system.GetPositionBuffer()\n      const colors = system.GetColorBuffer()\n      const offsetsArray = this.geometry.attributes.offset.array\n      const colorsArray = this.geometry.attributes.color.array\n      for (var i2 = 0, i3 = 0, i4 = 0, l = particles.length; i2 < l; i2 += 2, i3 += 3, i4 += 4) {\n        offsetsArray[i3] = 0\n        offsetsArray[i3 + 1] = 0\n        offsetsArray[i3 + 2] = 0\n        colorsArray[i4] = colors[i4] * inv255\n        colorsArray[i4 + 1] = colors[i4 + 1] * inv255\n        colorsArray[i4 + 2] = colors[i4 + 2] * inv255\n        colorsArray[i4 + 3] = colors[i4 + 3] * inv255\n      }\n    }\n    this.geometry.attributes.offset.needsUpdate = true\n    this.geometry.attributes.color.needsUpdate = true\n  }\n\n  draw (world) {\n    for (let system of world.particleSystems) {\n      const particles = system.GetPositionBuffer()\n      const velocities = system.GetVelocityBuffer()\n      // uncomment the chunks below if you want to apply the color transfer filter \n      // const colors = system.GetColorBuffer()\n      const offsetsArray = this.geometry.attributes.offset.array\n      // const colorsArray = this.geometry.attributes.color.array\n      for (var i2 = 0, i3 = 0, i4 = 0, l = particles.length; i2 < l; i2 += 2, i3 += 3, i4 += 4) {\n        const y = particles[i2 + 1]\n        if (y < -25) {\n          particles[i2 + 0] = -15 + Math.random() * 30\n          particles[i2 + 1] = 30 + Math.random() * 2\n          velocities[i2 + 0] = 0\n          velocities[i2 + 1] = 0\n          // // if you want to change the color as well on reset:\n          // colors[i4 + 0] = 0//Math.round(Math.random() * 255)\n          // colors[i4 + 1] = 0//Math.round(Math.random() * 255)\n          // colors[i4 + 2] = 255//Math.round(Math.random() * 255)\n          // colors[i4 + 3] = 255\n        }\n        offsetsArray[i3] = particles[i2]\n        offsetsArray[i3 + 1] = particles[i2 + 1]\n        // colorsArray[i4] = colors[i4] * inv255\n        // colorsArray[i4 + 1] = colors[i4 + 1] * inv255\n        // colorsArray[i4 + 2] = colors[i4 + 2] * inv255\n        // colorsArray[i4 + 3] = colors[i4 + 3] * inv255\n      }\n    }\n    this.geometry.attributes.offset.needsUpdate = true\n    // this.geometry.attributes.color.needsUpdate = true\n  }\n}","import { WebGLRenderer } from 'three'\n\nexport default class Renderer extends WebGLRenderer {\n  constructor () {\n    super ({\n      // antialias: true,\n      antialias: false,\n      alpha: true,\n    })\n\n    this.setClearColor(0, 0)\n    this.setSize(this.windowWidth, this.windowHeight)\n    this.setPixelRatio(window.devicePixelRatio)\n    this.shadowMap.enabled = false\n\n    const gl = this.getContext()\n    if (!gl.getExtension('OES_texture_float')) {\n      alert('client support error - float textures not supported')\n      throw new Error('float textures not supported')\n    }\n    // we need to access textures from within the vertex shader\n    //https://github.com/KhronosGroup/WebGL/blob/90ceaac0c4546b1aad634a6a5c4d2dfae9f4d124/conformance-suites/1.0.0/extra/webgl-info.html\n    if (gl.getParameter(gl.MAX_VERTEX_TEXTURE_IMAGE_UNITS) === 0) {\n      alert('client support error - vertex shader cannot read textures')\n      throw new Error('vertex shader cannot read textures')\n    }\n    \n  }\n}\n","export const walls = [\n  // starts top left to right bottom\n  [\n    [ -16, 26 ],\n    [ -16, 25 ],\n    [ 10, 20 ],\n    [ 10, 21 ],\n  ],    \n  [\n    [ 19, 21 ],\n    [ 19, 20 ],\n    [ 5, 12 ],\n    [ 5, 13 ],\n  ],\n  [\n    [ 0, 14 ],\n    [ 0, 15 ],\n    [ 5, 13 ],\n    [ 5, 12 ],\n  ],    \n  [\n    [ -16, 6.5 ],\n    [ -16, 7.5 ],\n    [ -12, 5 ],\n    [ -12, 4 ],\n  ],        \n  [\n    [ -16, 32 ],\n    [ -16, 6.5 ],\n    [ -17, 6.5 ],\n    [ -17, 32 ],\n  ],        \n  [\n    [ -12, 4 ],\n    [ -12, 5 ],\n    [ 8, 5.5 ],\n    [ 9, 4.5 ],\n  ],        \n  [\n    [ 22, 25 ],\n    [ 23, 25 ],\n    [ 19, 4 ],\n    [ 18, 4 ],\n  ],    \n  [\n    [ 19, 4 ],\n    [ 18, 4 ],\n    [ 7, 0 ],\n    [ 19, 0 ],\n  ],        \n  // main ground part\n  [\n    [ 0, -10 ],\n    [ -20, -9 ],\n    [ 0, -8 ],\n    [ 20, -9 ],\n  ]\n]\n","import { walls } from './Shapes'\n\nimport { b2BodyDef,\n  b2World,\n  b2Vec2,\n  b2CircleShape,\n  b2PolygonShape,\n  b2ParticleSystemDef,\n  b2ParticleGroupDef,\n  // b2_waterParticle,\n  b2_dynamicBody,\n  // b2_colorMixingParticle,\n  // b2MouseJointDef, \n  // b2AABB\n}from './liquidfun/ExternalsResolver'\n  \nimport { penguin } from './../assets/penguin.json'\n\nexport default class Simulation {\n\n  constructor (numberOfPenguins, spawnAreaRadius, liquidColor) {\n    // Initialize a world to run simulations on\n    const gravity = new b2Vec2(0, -10)\n    this.world = new b2World(gravity)\n    // create a physics reference to the ground, needed for handling the mouse\n    const groundBodyDef = new b2BodyDef()\n    this.groundBody = this.world.CreateBody(groundBodyDef)\n    // because liquidfun was compiled to use the global scope (window) \n    // we need to make sure it's available outside of the module\n    window.world = this.world\n\n    this.makeWalls()\n    this.makeLiquidParticles(spawnAreaRadius, liquidColor)\n    this.makePengiuns(numberOfPenguins)\n  }\n\n  makeWalls() {\n    const def = new b2BodyDef()\n    const ground = this.world.CreateBody(def)\n    for (let wall of walls) {\n      const shape = new b2PolygonShape()\n      for (let xy of wall) {\n        shape.vertices.push(new b2Vec2(...xy))\n      }\n      ground.CreateFixtureFromShape(shape, 0.0)\n    }\n  }\n\n  makeLiquidParticles (spawnAreaRadius = 2, liquidColor = [160, 110, 240, 255]) {\n\n    const psd = new b2ParticleSystemDef();\n    psd.radius = 0.07;\n    const particleSystem = this.world.CreateParticleSystem(psd);\n\n    // one group\n    const spawnArea = new b2CircleShape()\n    spawnArea.position.Set(0, 30)\n    spawnArea.radius = spawnAreaRadius\n    const particleGroupDefinition = new b2ParticleGroupDef()\n    particleGroupDefinition.shape = spawnArea\n    particleGroupDefinition.color.Set(...liquidColor)\n    particleSystem.CreateParticleGroup(particleGroupDefinition)\n  }        \n  makePengiuns (numberOfPenguins) {\n    const penguinVertices = penguin.fixtures[0].vertices\n    const scale = 0.014\n    let bd = new b2BodyDef()\n    bd.type = b2_dynamicBody\n    bd.sleep = false\n    for (let i = 0; i < numberOfPenguins; i++) {\n      let body = this.world.CreateBody(bd)\n      for (let triangle of penguinVertices) {\n        const shape = new b2PolygonShape;\n        for (let vertice of triangle) {\n          shape.vertices.push(new b2Vec2(\n            vertice.x * scale,\n            vertice.y * scale\n          ))\n        }\n        body.CreateFixtureFromShape(shape, 0.5)\n      }\n      body.childName = 'penguin-' + (i + 1)\n      body.SetTransform(new b2Vec2(-15+i*4, 30), 0)\n      body.SetLinearVelocity(new b2Vec2(0,0))\n      body.SetAngularVelocity(0)  \n    }\n  }\n\n  destroy () {\n    if (this.world !== null) {\n      while (this.world.joints.length > 0) {\n        this.world.DestroyJoint(this.world.joints[0]);\n      }\n      while (this.world.bodies.length > 0) {\n        this.world.DestroyBody(this.world.bodies[0]);\n      }\n      while (this.world.particleSystems.length > 0) {\n        this.world.DestroyParticleSystem(this.world.particleSystems[0]);\n      }\n    }\n  }\n}\n","export const LiquidShader = {\n\n\tuniforms: {\n\t\ttDiffuse: { value: null },\n\t},\n\n  vertexShader: `\n    varying vec2 vUv;\n    void main() {\n\t\t\tvUv = uv;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n    }\n  `,\n\t\n\tfragmentShader: `\n    uniform sampler2D tDiffuse;\n\t\tvarying vec2 vUv;\n\t\tvoid main() {\n      vec4 sample = texture2D(tDiffuse, vUv);\n      if (sample.a < 0.35) {\n        discard;\n      }\n      if (sample.a < 0.45) {\n        gl_FragColor = vec4(1.0);\n      } else {\n        gl_FragColor = sample;\n      }\n\t\t}\n  `\n}\t\n","\nexport const LayersBlendShader = {\n\n\tuniforms: {\n\n\t\t'textureBackground': { type: 't', value: null },\n\t\t'textureLiquid': { type: 't', value: null },\n\t\t'tDiffuse': { type: 't', value: null },\n\t},\n\n\tvertexShader: `\n\t  varying vec2 vUv;\n\t\tvoid main() {\n\t\t\tvUv = uv;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t}\n\t`,\n\n\tfragmentShader: `\n\n\t\tuniform sampler2D textureBackground;\n\t\tuniform sampler2D textureLiquid;\n\t\tuniform sampler2D tDiffuse;\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\t\t\tvec4 background = texture2D(textureBackground, vUv);\n\t\t\tvec4 liquid = texture2D(textureLiquid, vUv);\n\t\t\tvec4 foreground = texture2D(tDiffuse, vUv);\n\t\t\tvec3 color = background.rgb;\n\t\t\tcolor = mix(color.rgb, liquid.rgb, mix(liquid.a, foreground.a, 0.5));\n\t\t\tcolor = mix(color.rgb, foreground.rgb, foreground.a);\n\t\t\tfloat alpha = max(max(background.a, liquid.a), foreground.a);\n\t\t\tgl_FragColor = vec4(color, alpha);\n\t\t}\n\t`\n}\n\t","import { Mesh, MeshBasicMaterial, InstancedBufferGeometry, PlaneBufferGeometry, BoxGeometry, Sprite, TextureLoader, SpriteMaterial, RepeatWrapping } from 'three'\n\nimport { b2Vec2 } from './liquidfun/ExternalsResolver'\n\nexport default class Penguin extends Sprite {\n  \n  constructor () {\n    const map = new TextureLoader().load(\n      require('./../assets/penguin.png'),\n      texture => {\n        // flip the texture vertically to match our geometry\n        texture.wrapT = RepeatWrapping\n        texture.repeat.y = - 1\n      })\n    const material = new SpriteMaterial({ map })\n    super(material)\n  }\n\n  draw (body) {\n    const position = body.GetWorldCenter()\n    const angle = body.GetAngle()\n    if (position.y < -25) {\n      body.SetTransform(new b2Vec2(0, 30), 0)\n      body.SetLinearVelocity(new b2Vec2(0,0))\n      body.SetAngularVelocity(0)\n    }\n    this.position.x = position.x\n    this.position.y = position.y\n    const imageSize = {\n      width: 243,\n      height: 111\n    }\n    const scale = 0.015\n    this.scale.set(\n      imageSize.width * scale, \n      imageSize.height * scale,\n      1\n    )\n    this.material.rotation = angle\n  }\n}\n","import { Clock, PerspectiveCamera, Scene, Vector3, OrthographicCamera, ShapeUtils, Sprite, SpriteMaterial, TextureLoader, RepeatWrapping } from 'three'\nimport { b2Vec2, b2World, b2BodyDef, b2MouseJointDef, b2AABB } from './liquidfun/ExternalsResolver'\nimport DynamicBodyQueryCallback from './liquidfun/DynamicBodyQueryCallback'\nimport {lerp} from './../utils/lerp'\nimport DebugLayer from './DebugLayer'\nimport LiquidParticles from './LiquidParticles'\nimport Renderer from './Renderer'\nimport Simulation from './Simulation'\nimport { EffectComposer } from 'three/examples/jsm/postprocessing/EffectComposer'\nimport { ShaderPass } from 'three/examples/jsm/postprocessing/ShaderPass'\nimport { RenderPass } from 'three/examples/jsm/postprocessing/RenderPass'\nimport { LiquidShader } from './LiquidShader'\nimport { CopyShader } from 'three/examples/jsm/shaders/CopyShader.js';\nimport { LayersBlendShader } from './LayersBlendShader.js';\nimport Penguin from './Penguin'\n\nexport default class Stage {\n\n  static instance = null\n  \n  static initialize (container, cameraMode) {\n    if (!Stage.instance) {\n      Stage.instance = new Stage(container, cameraMode)\n    }\n  }\n  \n  static destroy () {\n    Stage.instance && Stage.instance.destroy()\n  }\n  \n  static setcameraMode (mode) {\n    Stage.instance && Stage.instance.setcameraMode(mode)\n  }\n  \n  // settings:\n  settings = {\n    liquidColor: [60, 110, 240, 255],\n    numberOfPenguins: 6,\n    spawnAreaRadius: 4,\n    debugPhysics: false,\n    // debugPhysics: true,\n    velocityIterations: 1,\n    positionIterations: 1,\n  }\n\n  leader = {\n    name: '',\n    position: {\n      x:0, y:0\n    }\n  }\n\n  // physics:\n  simulation\n  mouseJoint\n  // three:\n  renderer\n  composer\n  cameraMode = 'follow'\n  // scenes\n  sceneBackground\n  sceneLiquid\n  sceneForeground\n  // meshes\n  penguins = {}\n  liquidParticles\n  // debug\n  debugLayer\n  // utils:\n  clock\n  paused\n  renderCallBack\n\n  constructor (container, cameraMode) {\n\n    this.container = container\n    this.cameraMode = cameraMode\n\n    this.clock = new Clock()\n\n    this.simulation = new Simulation(\n      this.settings.numberOfPenguins, \n      this.settings.spawnAreaRadius,\n      this.settings.liquidColor\n    )\n    \n    // set the 4th penguin as camera target to follow\n    for (let body of this.simulation.world.bodies) {\n      const {childName} = body\n      if (childName === 'penguin-4') {\n        this.targetToFollow = body\n      }\n    }\n    \n    this.renderer = new Renderer()\n    \n    this.camera = new PerspectiveCamera(\n      /* fov */    70,\n      /* aspect */ window.innerWidth / window.innerHeight,\n      /* near */   0.001,\n      /* far */    50\n    )\n    \n    this.sceneBackground = new Scene()\n    this.sceneLiquid = new Scene()\n    this.sceneForeground = new Scene()\n    \n    this.container.appendChild(this.renderer.domElement)\n    \n    this.liquidParticles = new LiquidParticles(this.simulation)\n    this.sceneLiquid.add(this.liquidParticles)\n    \n    if (this.settings.debugPhysics) {\n      this.debugLayer = new DebugLayer()\n      this.sceneForeground.add(this.debugLayer.buffer)\n    }\n\n    const backgroundMap = new TextureLoader().load(require('./../assets/background.png'))\n    \n    const backgroundMaterial = new SpriteMaterial({\n      map: backgroundMap,\n      // sizeAttenuation: false\n    })\n    this.background = new Sprite(backgroundMaterial)\n    this.sceneBackground.add(this.background)\n    \n    const scale = 40\n    this.background.position.x = 3\n    this.background.position.y = 11\n    this.background.position.z = -1\n    this.background.scale.set(scale, scale, scale)\n  \n    const renderPassBackground = new RenderPass(this.sceneBackground, this.camera)\n    const renderPassLiquid = new RenderPass(this.sceneLiquid, this.camera)\n    const renderPassForeground = new RenderPass(this.sceneForeground, this.camera)\n\n    const backgroundCopyPass = new ShaderPass(CopyShader)\n    \n    this.effectLiquid = new ShaderPass(LiquidShader)\n    const liquidCopyPass = new ShaderPass(CopyShader)\n    \n    //final blend pass is drawn to screen\n    const blendPass = new ShaderPass(LayersBlendShader)\n    \n    \n    this.composerBackground = new EffectComposer(this.renderer)\n    this.composerBackground.addPass(renderPassBackground)\n    this.composerBackground.addPass(backgroundCopyPass)\n\n    this.composerLiquid = new EffectComposer(this.renderer)\n    this.composerLiquid.addPass(renderPassLiquid)\n    this.composerLiquid.addPass(this.effectLiquid)\n    this.composerLiquid.addPass(liquidCopyPass)\n    \n    this.composerForeground = new EffectComposer(this.renderer)\n    this.composerForeground.addPass(renderPassForeground)\n    this.composerForeground.addPass(blendPass)\n\n\n    blendPass.uniforms.textureBackground.value = this.composerBackground.renderTarget1.texture\n    blendPass.uniforms.textureLiquid.value = this.composerLiquid.renderTarget1.texture\n    blendPass.renderToScreen = true\n    \n    for (let i = 0; i < this.settings.numberOfPenguins; i += 1) {\n      const name = `penguin-${i + 1}`\n      const penguin = new Penguin()\n      this.penguins[name] = penguin\n      this.sceneForeground.add(penguin)\n    }\n\n    this.addListeners()\n    this.handleWindowResize()\n    this.loop()\n  }\n\n  setcameraMode (mode) {\n    this.cameraMode = mode\n  }\n\n\n  loop = () => {\n    this.renderCallBack = requestAnimationFrame(this.loop)\n    this.render()\n  }\n    \n  render () {\n    if (this.paused) {\n      return\n    }\n\n    // position camera\n    if (this.cameraMode === 'follow' && this.targetToFollow) {\n      const pt = this.targetToFollow.GetTransform().p\n      this.camera.position.x = lerp(this.camera.position.x, pt.x, 0.8)\n      this.camera.position.y = lerp(this.camera.position.y, pt.y, 0.8)\n      this.camera.position.z = lerp(this.camera.position.z, 11, 0.8)\n    } else {\n      this.camera.position.x = lerp(this.camera.position.x, 3, 0.98)\n      this.camera.position.y = lerp(this.camera.position.y, 11, 0.98)\n      this.camera.position.z = lerp(this.camera.position.z, 28, 0.98)\n    }\n\n    const elapsedTime = this.clock.elapsedTime\n    const delta = this.clock.getDelta()\n    this.simulation.world.Step(Math.min(0.03, delta), this.settings.velocityIterations, this.settings.positionIterations)\n\n    if (this.settings.debugPhysics) {\n      this.debugLayer.currentVertex = 0\n      this.debugLayer.draw(this.simulation.world)\n    }\n    \n    this.liquidParticles.draw(this.simulation.world)\n  \n    for (let body of this.simulation.world.bodies) {\n      const {childName} = body\n      if (childName && childName in this.penguins) {\n        this.penguins[childName].draw(body)\n      }\n    }\n    this.renderer.clear()\n\n    this.composerBackground.render()\n    this.composerLiquid.render()\n    this.composerForeground.render()\n  }\n  \n  handleWindowResize = () => {\n    this.stageWidth = window.innerWidth\n    this.stageHeight = window.innerHeight\n    this.renderer.setSize(this.stageWidth, this.stageHeight)\n    this.camera.aspect = this.stageWidth / this.stageHeight\n    this.camera.updateProjectionMatrix()\n    this.composerBackground.setSize(this.stageWidth, this.stageHeight)\n    this.composerLiquid.setSize(this.stageWidth, this.stageHeight)\n    this.composerForeground.setSize(this.stageWidth, this.stageHeight)\n  }\n  \n  handleMouseDown = event => {\n    if (this.mouseJoint) {\n      this.simulation.world.DestroyJoint(this.mouseJoint)\n      this.mouseJoint = null\n    }\n    const p = this.getMouseCoords(event)\n    const aabb = new b2AABB()\n    const d = new b2Vec2()\n    d.Set(0.01, 0.01)\n    b2Vec2.Sub(aabb.lowerBound, p, d)\n    b2Vec2.Add(aabb.upperBound, p, d)\n\n    const queryCallback = new DynamicBodyQueryCallback(p)\n    this.simulation.world.QueryAABB(queryCallback, aabb)\n\n    if (queryCallback.fixture) {\n      const {body} = queryCallback.fixture\n      const md = new b2MouseJointDef()\n      md.bodyA = this.simulation.groundBody\n      md.bodyB = body\n      md.target = p\n      md.maxForce = 1000 * body.GetMass()\n      this.mouseJoint = this.simulation.world.CreateJoint(md)\n      body.SetAwake(true)\n      this.targetToFollow = body\n    }\n  }\n\n  handleMouseMove = event => {\n    if (this.mouseJoint) {\n      const p = this.getMouseCoords(event)\n      this.mouseJoint.SetTarget(p)\n    }\n  }\n\n  handleMouseUp = event => {\n    if (this.mouseJoint) {\n      this.simulation.world.DestroyJoint(this.mouseJoint)\n      this.mouseJoint = null\n    }\n  }\n\n  getMouseCoords (event) {\n    const {touches} = event\n    const {top, left} = this.renderer.domElement.getBoundingClientRect()    \n    let clientX, clientY\n    if (touches && touches.length) {\n      clientX = touches[0].clientX - left \n      clientY = touches[0].clientY  - top\n    } else {\n      clientX = event.clientX - left \n      clientY = event.clientY - top\n    }\n\n    const mouse = new Vector3()\n    mouse.x = (clientX / this.stageWidth) * 2 - 1\n    mouse.y = -(clientY / this.stageHeight) * 2 + 1\n    mouse.z = 0.5\n    mouse.unproject(this.camera)\n    const dir = mouse.sub(this.camera.position).normalize()\n    const distance = -this.camera.position.z / dir.z\n    const pos = this.camera.position.clone().add(dir.multiplyScalar(distance))\n    return new b2Vec2(pos.x, pos.y)\n  }\n\n  destroy () {\n    window.cancelAnimationFrame(this.renderCallBack)\n    this.simulation.destroy()\n    this.removeListeners()\n  }\n\n  addListeners () {\n    document.addEventListener('touchstart', this.handleMouseDown, false)\n    document.addEventListener('touchmove', this.handleMouseMove, false)\n    document.addEventListener('touchend', this.handleMouseUp, false)\n    document.addEventListener('touchcancel', this.handleMouseUp, false)\n\n    document.addEventListener('mousedown', this.handleMouseDown, false)\n    document.addEventListener('mousemove', this.handleMouseMove, false)\n    document.addEventListener('mouseup', this.handleMouseUp, false)\n    document.addEventListener('mouseout', this.handleMouseUp, false)\n\n    window.addEventListener('resize', this.handleWindowResize, false)\n  }\n\n  removeListeners () {\n    document.removeEventListener('touchstart', this.handleMouseDown)\n    document.removeEventListener('touchmove', this.handleMouseMove)\n    document.removeEventListener('touchend', this.handleMouseUp)\n    document.removeEventListener('touchcancel', this.handleMouseUp)\n\n    document.removeEventListener('mousedown', this.handleMouseDown)\n    document.removeEventListener('mousemove', this.handleMouseMove)\n    document.removeEventListener('mouseup', this.handleMouseUp)\n    document.removeEventListener('mouseout', this.handleMouseUp)\n\n    window.removeEventListener('resize', this.handleWindowResize)\n  }\n\n}\n  ","<template>\n  <div id=\"app\">\n    <div class=\"canvas-container\" ref=\"canvas-container\"></div>\n    <button @click=\"toggleCameraMode\">Toggle Camera View - {{cameraMode}}</button> \n  </div>\n</template>\n\n<script>\nimport Stage from './engine/Stage'\n\nexport default {\n  name: 'App',\n  data: () => ({\n    cameraMode: 'full'\n  }),\n  mounted () {\n    Stage.initialize(this.$refs['canvas-container'], this.cameraMode)\n  },\n  beforeDestroy () {\n    Stage.destroy()\n  },\n  methods: {\n    toggleCameraMode () {\n      this.cameraMode = this.cameraMode === 'follow' ? 'full' : 'follow'\n      Stage.setcameraMode(this.cameraMode)\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\">\nbody {\n  background: black;\n  margin: 0;\n  overflow: hidden;\n  font-size: 18px;\n\n  .canvas-container {\n    width: 100vw;\n    height: 100vh;\n    position: relative;\n    background: #bcf5ff;\n    canvas {\n      position: absolute;\n      top: 0;\n      right: 0;\n      bottom: 0;\n      left: 0;\n    }\n  }\n  button {\n    position: fixed;\n    top: 0.5rem;\n    left: 0.5rem;\n    border: 2px solid #ffffff;\n    border-radius: 5px;\n    background: #4c73b4;\n    color: white;\n    font-family: monospace;\n    font-weight: 100;\n    font-size: 1rem;\n    padding: 0.25rem 1rem;\n    cursor: pointer;\n    z-index: +1;\n    &:focus {\n      outline: none;\n    }\n  }\n}\n</style>\n","import mod from \"-!../node_modules/cache-loader/dist/cjs.js??ref--12-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../node_modules/cache-loader/dist/cjs.js??ref--12-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./App.vue?vue&type=template&id=3228bdef&\"\nimport script from \"./App.vue?vue&type=script&lang=js&\"\nexport * from \"./App.vue?vue&type=script&lang=js&\"\nimport style0 from \"./App.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","import Vue from 'vue'\nimport App from './App.vue'\n\nVue.config.productionTip = false\n\nnew Vue({\n  render: h => h(App),\n}).$mount('#app')\n\n/**\n * This demo is going to be hosted in iframe and needs to be responsive\n */\nconst handleResize = () => {\n  const width = window.innerWidth\n  const height = width * 0.75\n  try {\n    window.parent.postMessage({\n      'event-type': 'iframe-content-resize',\n      width, \n      height\n    },\n    document.location.origin)\n  } catch (e) {\n    // nothing to do here\n  }\n}\nhandleResize()\nwindow.addEventListener('resize', handleResize)\n\n","import mod from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=style&index=0&lang=scss&\"; export default mod; export * from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=style&index=0&lang=scss&\"","module.exports = __webpack_public_path__ + \"img/penguin.d1a92372.png\";"],"sourceRoot":""}